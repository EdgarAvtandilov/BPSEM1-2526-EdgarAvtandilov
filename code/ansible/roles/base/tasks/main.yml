---
- name: Configure system settings (combined)
  cisco.ios.ios_config:
    lines:
      - hostname {{ inventory_hostname }}
      - ip domain-name {{ domain_name }}
      - service password-encryption
      - service timestamps log datetime msec
      - username ansible privilege 15 secret {{ vault_login_password }}
      - enable secret {{ vault_enable_password }}
      - ip ssh version 2
      - logging host {{ logging_host }}
      - logging trap informational
      - ntp server {{ ntp_server }} prefer
      - |
        banner motd ^C
        {{ banner_motd }}
        ^C
    match: line
  register: config_result

- name: Configure VTY lines for SSH
  cisco.ios.ios_config:
    lines:
      - transport input ssh
      - login local
    parents: line vty 0 15
  when: config_result.changed